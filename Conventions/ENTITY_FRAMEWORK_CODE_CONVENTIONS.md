# Этот документ описывает основные правила по написанию кода и конфигурации сущностей для `Entity Framework`

**Все правила из файла `COMMON_CODE_CONVENTIONS` также применяются ко всем правилам по умолчанию!**

## Родительская сущность
  - Родительская сущность должна называться `EntityBase`.
  - Должна иметь первичный ключ соответствующего типа который будет создаваться по умолчанию.
  - Первичный ключ должен быть помечен аттрибутом `[Key]`.

## Дочерние сущности
- Все дочерние сущности должны наследоваться от `EntityBase`.
- Все дочерние сущности должны иметь обязательный постфикс `Entity`.
- Все дочерние сущности должны иметь аттрибут `[Table("{Название таблицы}")]`

## Свойства
- Все свойства должны быть помечены аттрибутами:
    - Автовычисляемые свойства которые не будут смаппены должны быть помечены аттрибутом `[NotMapped]`.
    - Свойства которые будут смаппены как обычные колонки должны быть помечены аттрибутом `[Column("{Имя колонки}")]`.
    - Свойства которые будут смаппены как внешние ключи должны быть помечены аттрибутом `[ForeignKey("{Имя внешнего ключа}")]`.
    - Навигационные свойства не должны иметь никаких аттрибутов.
 
## Конфигурация
- Свойства `DbSet<TEntity>` не должны иметь модификатор `set`, значения должны быть установлены сразу через метод `Set<TEntity>()`
- Большинство конфигураций **НЕ** должны быть указаны напрямую в `OnModelCreating` т.к большинство необходимых конфигурацией уже настроены через аттрибуты в сущностях.
- Если требуется создать определенную конфигурацию, для этого должны быть созданы методы расширения для `ModelBuilder`, и эти методы должны быть вызваны в переопределенном методе `OnModelCreating`.
- Создание методов расширений для `ModelBuilder` допустимы в случаях приведенных ниже (Если вашей ситуации нет в списке, значит вы неправильно сконфигурировали сущности через аттрибуты):
    - Метод расширения для создания и конфигурации индексов.
    - Метод расширения для конверсии свойств. (Например определенная колонка имеет сложный тип который невозможно хранить в БД, в его исходном виде, и необходимо использовать конверсию чтобы хранить эти данные как строку).
